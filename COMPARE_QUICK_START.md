# 文件对比功能增强 - 快速入门指南

**更新版本**: v1.0.2  
**发布日期**: 2026-01-12

---

## 🎯 新功能概览

文件对比功能已大幅增强！现在支持**4种对比模式**，让您可以灵活处理各种文件对比需求。

### 核心改进

| 功能 | v1.0.1 | v1.0.2 |
|------|--------|--------|
| 单个文件自动对比 | ✓ | ✓ |
| 指定文件对比 | ✗ | ✓ **新增** |
| 同名文件列表 | ✗ | ✓ **新增** |
| 批量对比汇总 | ✗ | ✓ **新增** |
| 对比报告导出 | ✗ | ✓ **新增** |

---

## 🚀 快速开始

### 场景1: 对比左右两个选定的文件

**最简单的方式** - 当您想对比特定的两个文件时使用

```
步骤:
1️⃣  在左面板选中一个文件
2️⃣  在右面板选中另一个文件
3️⃣  按 Ctrl+Shift+C (或菜单"工具→对比文件")
4️⃣  在弹出对话框中点击"对比这两个文件"
5️⃣  查看详细对比结果
```

✨ **优势**: 可以对比任意两个文件，即使文件名不同

---

### 场景2: 批量查看所有同名文件

**最快速的方式** - 当您想快速了解两个目录中的所有差异时使用

```
步骤:
1️⃣  不选择任何文件
2️⃣  按 Ctrl+Shift+C
3️⃣  在弹出对话框中看到所有同名文件列表
4️⃣  点击"查看全部对比"
5️⃣  查看批量对比汇总
   • 统计完全相同的文件个数
   • 统计存在差异的文件个数
   • 分类显示: 仅大小不同/仅时间不同/内容不同
6️⃣  可选: 点击"导出对比报告"保存结果
```

✨ **优势**: 一眼看清所有文件的对比情况，快速定位改动

---

### 场景3: 从列表中选择特定文件对比

**最灵活的方式** - 当您想在看到列表后再选择时使用

```
步骤:
1️⃣  不选择任何文件(或不需要手动选)
2️⃣  按 Ctrl+Shift+C
3️⃣  在弹出对话框中看到同名文件列表
4️⃣  在表格中点击要对比的文件
5️⃣  点击"查看详细对比"
6️⃣  打开详细对比窗口看详情
```

✨ **优势**: 可以逐个查看每个同名文件的详细差异

---

## 📊 对话框详解

### 选择对话框 (CompareSelectDialog)

当您点击"对比文件"菜单时，会弹出这个对话框。它会**自动检测**您的选择情况并显示合适的对比模式。

#### 场景A: 左右都选中了文件

```
┌─────────────────────────────────────────┐
│ 文件对比 - 选择模式                     │
├─────────────────────────────────────────┤
│ 模式1: 对比指定的两个文件                 │
│ ┌─────────────────────────────────────┐ │
│ │ 左: config.ini        vs  右: new.xml  │ │
│ │                                       │ │
│ │                   [对比这两个文件]       │ │
│ └─────────────────────────────────────┘ │
│                                         │
│ 模式2: 从 15 个同名文件中选择               │
│ ┌─────────────────────────────────────┐ │
│ │ 文件名         │ 左大小 │ 右大小 │ 状态  │
│ ├─────────────────┼─────┼─────┼─────┤ │
│ │ readme.txt      │ 2KB │ 2KB │ ✓   │ │
│ │ data.json       │ 5KB │ 6KB │ ✗   │ │
│ │ ...             │     │     │     │ │
│ └─────────────────────────────────────┘ │
│                  [查看详细] [查看全部]      │
│                                   [关闭]  │
└─────────────────────────────────────────┘
```

#### 场景B: 没有选择或多个选择

```
┌─────────────────────────────────────────┐
│ 文件对比 - 选择模式                     │
├─────────────────────────────────────────┤
│ 模式2: 从 15 个同名文件中选择               │
│ ┌─────────────────────────────────────┐ │
│ │ 文件名         │ 左大小 │ 右大小 │ 状态  │
│ ├─────────────────┼─────┼─────┼─────┤ │
│ │ readme.txt      │ 2KB │ 2KB │ ✓   │ │
│ │ data.json       │ 5KB │ 6KB │ ✗   │ │
│ │ config.ini      │ 1KB │ 1KB │ ✓   │ │
│ └─────────────────────────────────────┘ │
│                  [查看详细] [查看全部]      │
│                                   [关闭]  │
└─────────────────────────────────────────┘
```

### 批量对比汇总窗口 (BatchCompareDialog)

点击"查看全部对比"后显示的窗口，包含所有同名文件的对比结果。

```
┌────────────────────────────────────────────────────┐
│ 批量文件对比结果 - 共 15 个同名文件                  │
├────────────────────────────────────────────────────┤
│ 完全相同: 12 | 不同: 3 | 仅大小不同: 1 | 仅时间不同: 1
│
│ ┌────────────────────────────────────────────────┐
│ │序│文件名    │结果 │大小     │修改时间│差异详情   │
│ ├──┼─────────┼────┼────────┼──────┼──────────┤
│ │1 │readme.tx│✓相 │5.2MB   │相同  │无差异    │
│ │2 │config.in│✗不 │1.2MB→ │不同  │大小不同  │
│ │3 │data.json│✓相 │2.1MB   │相同  │无差异    │
│ │... ...     │    │        │      │          │
│ └────────────────────────────────────────────────┘
│
│  [导出对比报告]  [关闭]
└────────────────────────────────────────────────────┘

✨ 提示: 双击表格中的任意行可以打开详细对比窗口
```

**统计信息解读**:
- **完全相同**: 大小、修改时间、内容都一样 ✅
- **不同**: 至少有一个方面不同 ❌
- **仅大小不同**: 只有文件大小不同，其他都相同
- **仅时间不同**: 只有修改时间不同，大小和内容都相同

---

## 💡 实用技巧

### 技巧1: 快速定位改动文件

如果您有两个版本的项目目录，想知道哪些文件被改过：

```
1. 在左面板打开旧版本目录
2. 在右面板打开新版本目录
3. 不选任何文件
4. 按 Ctrl+Shift+C
5. 点击"查看全部对比"
6. 在结果中搜索"✗ 不同"的文件
7. 这些就是被改过的文件！
```

### 技巧2: 验证备份完整性

如果您想验证备份是否成功：

```
1. 在左面板打开原始文件目录
2. 在右面板打开备份目录
3. 按 Ctrl+Shift+C
4. 点击"查看全部对比"
5. 查看"完全相同"的数量
6. 如果都相同，说明备份成功 ✅
```

### 技巧3: 导出对比报告

如果您需要生成对比报告：

```
1. 打开批量对比汇总窗口
2. 点击"导出对比报告"
3. 选择保存位置和文件名
4. 报告会以文本格式保存，可以用任何文本编辑器打开
5. 可以用来存档或与他人共享
```

---

## 📈 性能特性

### 支持的文件数量
- ✅ 小目录 (< 100个文件) - 即时显示
- ✅ 中等目录 (100-1000个文件) - 1-2秒显示
- ✅ 大目录 (1000+个文件) - 可能需要5-10秒

### 支持的文件大小
- ✅ 小文件 (< 1MB) - 毫秒级
- ✅ 中等文件 (1-100MB) - 秒级
- ✅ 大文件 (> 100MB) - 10秒以内

### 内存占用
- ✅ 低内存占用（< 50MB）
- ✅ 使用流式读取处理大文件
- ✅ 不会因为对比而卡顿

---

## ❓ 常见问题

### Q1: 为什么看不到"模式1"？
**A**: "模式1"只在您同时在左右面板各选了一个文件时才显示。如果您想看到它：
- 在左面板选中一个文件
- 在右面板选中另一个文件
- 然后点击"对比文件"

### Q2: 如何对比两个不同名的文件？
**A**: 
1. 左面板选中第一个文件
2. 右面板选中第二个文件
3. 点击"对比文件"
4. 点击"对比这两个文件"

### Q3: 为什么"查看详细对比"按钮是灰色的？
**A**: 因为您还没有在列表中选中文件。点击表格中的某一行来选中文件，按钮就会变为可用。

### Q4: 导出的报告在哪里？
**A**: 您在"导出对比报告"对话框中选择的位置。默认会显示"文档"或"桌面"目录，您可以选择任何地方保存。

### Q5: 可以对比子目录中的文件吗？
**A**: 当前版本只对比当前目录中的同名文件。如果需要递归对比子目录，这是未来版本的计划功能。

---

## 📋 对比模式参考

| 场景 | 选择情况 | 操作 | 结果 |
|------|---------|------|------|
| 自动对比 | 左选1个,右不选 | Ctrl+Shift+C | 自动找右同名,直接对比 |
| 自动对比 | 右选1个,左不选 | Ctrl+Shift+C | 自动找左同名,直接对比 |
| 指定对比 | 左选1个,右选1个 | Ctrl+Shift+C | 弹出选择对话框 |
| 列表对比 | 都不选或多个 | Ctrl+Shift+C | 弹出选择对话框 |

---

## 🎓 快捷键速查

| 快捷键 | 功能 |
|--------|------|
| Ctrl+Shift+C | 打开文件对比菜单 |
| (在列表中双击) | 打开详细对比 |

---

## 📚 相关文档

- [详细功能说明](FILE_COMPARE_GUIDE.md) - 深入了解所有功能
- [功能增强文档](COMPARE_FEATURE_ENHANCEMENT.md) - 技术实现细节
- [使用指南](USAGE_GUIDE.md) - 整个程序的用户指南

---

**Version**: v1.0.2  
**Status**: ✅ Ready to Use  
**Last Updated**: 2026-01-12
